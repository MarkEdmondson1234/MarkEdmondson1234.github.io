<!DOCTYPE html>
<html lang="en-GB">
<head>
    <title>R on Kubernetes - serverless Shiny, R APIs and scheduled scripts &middot; Mark Edmondson</title>
    <meta name="generator" content="Hugo 0.51" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="Mark Edmondson">
    
      <meta name="description" content="Some examples of running R applications on Google Kubernetes Engine">
    
    
    <link rel="canonical" href="https://code.markedmondson.me/r-on-kubernetes-serverless-shiny-r-apis-and-scheduled-scripts/"/>
    <link rel="icon" href="https://code.markedmondson.me/favicon.ico">
    <link rel="apple-touch-icon" href="https://code.markedmondson.me/apple-touch-icon.png"/>
    <link rel="stylesheet" href="https://code.markedmondson.me/css/style.css">
    <link rel="stylesheet" href="https://code.markedmondson.me/css/github.css" rel="stylesheet" id="theme-stylesheet">
    <link rel="stylesheet" href="https://code.markedmondson.me/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://code.markedmondson.me/fancybox/jquery.fancybox.css">
    
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
    <meta property="og:title" content="R on Kubernetes - serverless Shiny, R APIs and scheduled scripts" />
<meta property="og:description" content="Some examples of running R applications on Google Kubernetes Engine" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://code.markedmondson.me/r-on-kubernetes-serverless-shiny-r-apis-and-scheduled-scripts/" /><meta property="article:published_time" content="2018-05-02T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2018-05-02T00:00:00&#43;00:00"/>

    
    
<meta itemprop="name" content="R on Kubernetes - serverless Shiny, R APIs and scheduled scripts">
<meta itemprop="description" content="Some examples of running R applications on Google Kubernetes Engine">


<meta itemprop="datePublished" content="2018-05-02T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2018-05-02T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="3364">



<meta itemprop="keywords" content="docker,R," />

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="R on Kubernetes - serverless Shiny, R APIs and scheduled scripts"/>
<meta name="twitter:description" content="Some examples of running R applications on Google Kubernetes Engine"/>
<meta name="twitter:site" content="@HoloMarkeD"/>

    
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WFFMBH');</script>


    <script src="https://code.markedmondson.me/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
</head>
<body>
<div class="container">


<div id="container">
	<header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="https://code.markedmondson.me/" id="logo">
          
          <i class="logo" style="background-image: url('https://code.markedmondson.me/images/greenhand.png')"></i>
          
          <span class="site-title">Mark Edmondson</span>
      </a>
      <nav id="main-nav">
          
          
          <a class="main-nav-link" href="https://code.markedmondson.me/">Home</a>
          
          
          
          

          
          <a class="main-nav-link" href="/r-packages/">My R Packages</a>
          

          
          
          
          
          <a class="main-nav-link" href="http://markedmondson.me">Non-code blog</a>
          
          
      </nav>
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="https://code.markedmondson.me/images/gde_avatar.jpg"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
              <input type="search" name="q" class="search-form-input" placeholder="Search">
              <button type="submit" class="search-form-submit">
              </button>
              <input type="hidden" name="sitesearch" value="https://code.markedmondson.me/" />
         </form>
        </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tbody>
          <tr>
          
          
          <td><a class="main-nav-link" href="https://code.markedmondson.me/">Home</a></td>
          
          
          
          

          
          <td><a class="main-nav-link" href="/r-packages/">My R Packages</a></td>
          

          
          
          
          
          <td><a class="main-nav-link" href="http://markedmondson.me">Non-code blog</a></td>
          
          
          <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
          <input type="search" name="q" class="search-form-input" placeholder="Search">
          <input type="hidden" name="sitesearch" value="https://code.markedmondson.me/" />
          </form>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</header>

   	
   	<div class="outer">
   	
    	<aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      
      <img id="avatar" src="https://code.markedmondson.me/images/gde_avatar.jpg">
      
      <h2 id="name">Mark Edmondson</h2>
      <h3 id="title">Coding in digital analytics</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Copenhagen, Denmark</span>
      
          <a id="follow" href="https://github.com/MarkEdmondson1234">
              Follow
          </a>
      
    </div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        21
        <span>Posts</span>
      </div>
      <div class="article-info-block">
        
          15
        
        <span>
            Tags
        </span>
      </div>
    </div>
    <div class="profile-block social-links">
      <table>
        <tr>
          
<td><a href="//github.com/MarkEdmondson1234" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>























<td><a href="//youtube.com/MarkEdmondsonAtHome" target="_blank" title="YouTube"><i class="fa fa-youtube"></i></a></td>















<td><a href="//linkedin.com/in/markpeteredmondson" target="_blank" title="LinkedIn"><i class="fa fa-linkedin"></i></a></td>















<td><a href="//twitter.com/HoloMarkeD" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>


          <td><a href="https://code.markedmondson.me/index.xml" target="_blank" title="RSS"><i class="fa fa-rss"></i></a></td>
        </tr>
      </table>
    </div>
  </div>
</aside>

    

    <section id="main">
    
    <article id="page-undefined" class="article article-type-page" itemscope="" itemprop="blogPost">
    <div class="article-inner">
        
            <img src="https://code.markedmondson.me/banners/r-kubernetes.png" class="article-banner">
        

        <header class="article-header">
    <a href="https://code.markedmondson.me/r-on-kubernetes-serverless-shiny-r-apis-and-scheduled-scripts/">
    <h1 class="article-title" itemprop="name">
        R on Kubernetes - serverless Shiny, R APIs and scheduled scripts
    </h1>
    </a>
    <div class="article-meta">

        
        <div class="article-date">
            <i class="fa fa-calendar"></i>
            <time datetime="2018-05-02 00:00:00 &#43;0000 UTC" itemprop="datePublished">2018-05-02</time>
            &middot;
            3364
            words
            &middot;
            16
            minute read
        </div>
        
        
            
            
        

        
            
            
            <div class="article-category">
                <i class="fa fa-tags"></i>
                
                
                <a class="article-category-link" href="https://code.markedmondson.me/tags/docker">docker</a>
                &middot;
                
                
                <a class="article-category-link" href="https://code.markedmondson.me/tags/r">R</a>
                
                
            </div>
            
        
    </div>
</header>

        <div class="article-entry" itemprop="articleBody">
            <h2 id="why-run-r-on-kubernetes">Why run R on Kubernetes?</h2>

<p><a href="https://kubernetes.io/">Kubernetes</a> is a free and open-source utility to run jobs within a computer cluster.  It abstracts away the servers the jobs are running on so you need only worry about the code to run.  It has features such as <a href="https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/">scheduling</a>, <a href="https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-autoscaler">auto-scaling</a>, and auto-healing to replace nodes if they breakdown.</p>

<p>If you only need to run R on a single machine, then its probably a bit OTT to use Kubernetes, but if you are starting to work with multiple Docker containers and/or VMs it gets more and more attractive to have a way to easily orchestrate them.</p>

<p>Kubernetes works via <a href="https://www.docker.com/">Docker</a> containers, so if you are already familiar with using Docker for abstracting away code environments, it should be a short step up to abstracting away the computers those Docker containers run upon.</p>

<p>R is a good mix with Docker since it provides a way to have stable production environments in a landscape of shifting dependencies given R&rsquo;s fast changing open source foundation.  There is a growing ecosystem to help R users with Docker including the <a href="https://www.rocker-project.org/">Rocker Project</a>, <a href="http://o2r.info/2017/05/30/containerit-package/">containerit</a> and <a href="https://github.com/wch/harbor">harbor</a>, and Rhys Jackson has also crafted a Kubernetes client for R in <a href="https://github.com/RhysJackson/googleKubernetesR">googleKubernetesR</a>.</p>

<p>If your R scripts are deployed in Docker containers, you can use them in Kubernetes.  This includes applications such as R powered APIs using OpenCPU or plumber, Shiny apps, batch R jobs that can scale horizontally over many CPUs, or scheduled analysis.</p>

<p>What you gain is reliable, flexible, production ready R applications, that will scale, run on many cloud providers including Google, and once set up easy to deploy - in most cases pushing to GitHub can be the trigger to serve your new code.</p>

<h3 id="alternatives">Alternatives</h3>

<p>This article deploys to Google Kubernetes Engine (GKE), but there are many other methods to cover some of Kubernetes functionality, that you may prefer.</p>

<p><img src="../images/gke_icon.png" alt="" /></p>

<ul>
<li>Kubernetes itself can run on all the cloud providers aside Google Cloud Platform, as well as your own servers.</li>
<li><a href="https://cloud.google.com/appengine/docs/flexible/">Google App Engine Flexible</a> is a more managed platform that takes care of some details, but you lose control of others.  I wrote about this previously for running R APIs and a demo is in this <a href="https://github.com/MarkEdmondson1234/serverless-R-API-appengine">GitHub repo</a>.</li>
<li><a href="https://docs.docker.com/compose/">Docker Compose</a> is an equivalent service that only runs on one host, <a href="https://docs.docker.com/engine/swarm/">Docker Swarm</a> runs on multiple hosts and most comparible to Kubernetes.</li>
<li><a href="https://azure.microsoft.com/en-us/services/container-service/">Azure Container Service</a> is a more managed Kubernetes platform than GKE</li>
</ul>

<p>Regardless which one you use, the principles are similar in that they all build on Docker containers, and one of the advantages of Kubernetes is you can move to other providers a lot more easily, since Docker/Kubernetes is fast becoming the standard for cloud developments.</p>

<h3 id="setup-background">Setup background</h3>

<p>The below is a setup I have used for the above applications, and may be able to help if you are looking for similar functionality.</p>

<p>I ran into several gotchas whilst developing it, so hopefully it will help you avoid some of those. Most vexing for me was finding a way to serve different R scripts on one kubernetes cluster on different URL paths (e.g. <code>/r-script1</code>, <code>/shinyapp2</code>, <code>/r-api-3</code>, etc) - many thanks to Rhys&rsquo; help with that.  The answer was that (at the time of writing) the default Google Kubernetes Engine doesn&rsquo;t support rewriting URLs, so instead its better to install another application on your cluster to take care of the above URL serving (termed <code>ingress fanout</code>), namely using <code>nginx ingress</code> instead of the default GKE ingress.</p>

<p>This article then demonstrates:</p>

<ol>
<li>Creating a Kubernetes cluster for your R applications</li>
<li>Installing Helm (and Tiller) to aid with a nginx ingress installation</li>
<li>Deploying R containers, with examples for Shiny, an R API and an R scheduled script</li>
<li>Serving up those R containers on nice URLs</li>
</ol>

<h3 id="references">References</h3>

<p>These were used to help develop the below:</p>

<ul>
<li><a href="https://cloud.google.com/kubernetes-engine/docs/tutorials/http-balancer">Setting up HTTP load balancing with Ingress</a> Google tutorial</li>
<li><a href="https://cloud.google.com/community/tutorials/nginx-ingress-gke">Ingress with nginx</a> modified with <a href="https://docs.bitnami.com/kubernetes/how-to/configure-rbac-in-your-kubernetes-cluster/">this</a></li>
<li>My <a href="https://stackoverflow.com/questions/48452556/setting-up-a-kuberentes-cluster-with-http-load-balancing-ingress-for-rstudio-and">StackOverflow question</a> on http load balancing</li>
<li><a href="https://kubernetes.io/docs/reference/kubectl/overview/">Kubernetes reference documentation</a></li>
<li><a href="https://docs.bitnami.com/kubernetes/how-to/secure-kubernetes-services-with-ingress-tls-letsencrypt/">Kubernetes with nginx, TLS and LetsEncrypt</a></li>
</ul>

<h2 id="part-1-creating-an-r-cluster">Part 1 - Creating an R cluster</h2>

<p>Follow the <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/creating-a-container-cluster">setup steps to authenticate with gcloud and kuberctl</a> then create your cluster via:</p>

<pre><code class="language-sh">gcloud container clusters create r-cluster --num-nodes=3
</code></pre>

<p>&hellip;or if using <code>googleKubernetesR</code> :</p>

<pre><code class="language-r">library(googleKubernetesR)

## create a 3 node cluster called r-cluster with defaults
createCluster(projectId = gcp_get_project(), zone = &quot;europe-west3-b&quot;)
</code></pre>

<p>You&rsquo;ll need to wait a bit as it provisions all the VMs.</p>

<p>Most of the below will use the terminal/shell for working rather than R, but in the future a lot of this may be possible via <code>googleKubernetesR</code> within an R session.</p>

<p>Set up your shell to get the credentials for Kuberctl:</p>

<pre><code class="language-sh">gcloud container clusters get-credentials r-cluster
</code></pre>

<p>And we are all set to start setting up this cluster for R jobs!</p>

<p>Here is a screenshot from the web UI of what it should look like:</p>

<p><img src="../images/r-cluster.png" alt="" /></p>

<h2 id="part-2-install-the-nginx-ingress-controller">Part 2 - Install the nginx ingress controller</h2>

<p>The first recommended setup is to enable an ingress controller.</p>

<p><img src="../images/ingress_controller.png" alt="" /></p>

<p><em>Image from <a href="https://www.nginx.com/products/nginx/kubernetes-ingress-controller/">nginx</a></em></p>

<p>This is a pod that directs internet traffic to the right R container we set up later.</p>

<p>We install the ingress controller via <a href="https://helm.sh/">Helm</a> and its counterpart Tiller on the cluster.</p>

<p>Helm is a package manager for Kubernetes.</p>

<blockquote>
<p>You can skip installing Helm/Tiller/ingress controller if you don&rsquo;t need to have R apps on a URL, for instance if its just scheduled cron jobs you want on your cluster, but it is recommended if you want to serve up APIs and Shiny.</p>
</blockquote>

<p>The below is mostly copied straight from <a href="https://docs.bitnami.com/kubernetes/how-to/configure-rbac-in-your-kubernetes-cluster/">Bitnami</a>&rsquo;s article.</p>

<h3 id="install-helm">Install Helm</h3>

<p><em>The below assumes RBAC rules are enabled, which is true from Kubernetes version 1.8 onwards.</em></p>

<pre><code class="language-sh">curl -o get_helm.sh https://raw.githubusercontent.com/kubernetes/helm/master/scripts/get
chmod +x get_helm.sh
./get_helm.sh
</code></pre>

<h3 id="install-tiller-on-cluster">Install Tiller on cluster</h3>

<h4 id="step-1-create-the-tiller-service-account">Step 1: Create the Tiller service account</h4>

<p>Create a tiller-serviceaccount.yaml file using kubectl:</p>

<pre><code class="language-sh">kubectl create serviceaccount tiller --namespace kube-system
</code></pre>

<h4 id="step-2-bind-the-tiller-service-account-to-the-cluster-admin-role">Step 2: Bind the Tiller service account to the cluster-admin role</h4>

<p>Create a <code>tiller-clusterrolebinding.yaml</code> file with the following contents:</p>

<pre><code class="language-yaml">      kind: ClusterRoleBinding
      apiVersion: rbac.authorization.k8s.io/v1beta1
      metadata:
        name: tiller-clusterrolebinding
      subjects:
      - kind: ServiceAccount
        name: tiller
        namespace: kube-system
      roleRef:
        kind: ClusterRole
        name: cluster-admin
        apiGroup: &quot;&quot;
</code></pre>

<p>Deploy the ClusterRoleBinding:</p>

<pre><code class="language-sh">kubectl create -f tiller-clusterrolebinding.yaml
</code></pre>

<h4 id="step-3-update-the-existing-tiller-deployment">Step 3: Update the existing Tiller deployment</h4>

<p>Update the existing tiller-deploy deployment with the Service Account you created earlier:</p>

<pre><code class="language-sh">helm init --service-account tiller --upgrade
</code></pre>

<p>Wait a few seconds for the Tiller server to be redeployed.</p>

<h4 id="step-4-test-the-new-helm">Step 4: Test the new Helm</h4>

<p>All being well, you should be able to execute this command without errors:</p>

<pre><code class="language-sh">helm ls
</code></pre>

<p>And that&rsquo;s it! You have configured Helm in your Kubernetes cluster.</p>

<h4 id="step-5-deploy-ngnix-ingress-controller">Step 5: Deploy ngnix Ingress Controller</h4>

<p>Now you can deploy the <a href="https://kubernetes.github.io/ingress-nginx/">nginx ingress controller</a> using Helm to take care of details:</p>

<pre><code class="language-sh">helm install --name nginx-ingress stable/nginx-ingress --set rbac.create=true
</code></pre>

<p>You should see your IP when you issue:</p>

<pre><code class="language-sh">kubectl get service nginx-ingress-controller
#&gt; NAME                       CLUSTER-IP    EXTERNAL-IP   PORT(S)                      AGE
#&gt; nginx-ingress-controller   10.7.253.89   &lt;pending&gt;     80:32713/TCP,443:31061/TCP   23s
</code></pre>

<h2 id="part-3-deploying-r-workloads">Part 3 - Deploying R Workloads!</h2>

<p>Now the cluster is all setup for you to deploy your R containers.  You can install other containers in any other language too, such as normal HTML webapps or utilties.</p>

<p>We deploy them using the command <code>kubectl run</code>, and go through some examples below.</p>

<h3 id="a-shiny-apps">A: Shiny apps</h3>

<p>Below we deploy two Shiny apps, in this case the <a href="https://github.com/cloudyr/googleComputeEngineR/tree/master/inst/dockerfiles/shiny-googleAuthRdemo"><code>googleAuthR</code> demo app</a> that is configured to run on port 3838, in a <code>/shiny/</code> folder, and a <a href="https://github.com/flaviobarros/shiny-wordcloud">wordcloud Shiny app by Flavio Barros</a> that has had its Dockerfile configured to run on port 80 in the root folder, to demonstrate how to handle different Docker deployments.</p>

<pre><code class="language-sh">kubectl run shiny1 --image gcr.io/gcer-public/shiny-googleauthrdemo:latest --port 3838
kubectl run shiny2 --image=flaviobarros/shiny-wordcloud --port=80
</code></pre>

<h4 id="expose-containers-as-node-ports">Expose containers as node ports</h4>

<p>At the moment we are only selecting which services the cluster will run - we won&rsquo;t be able to see them yet until we expose the apps and configure the ingress rules</p>

<p>These will be pointed to via the nginx ingress controller.</p>

<p>We first open up their ports as nodeports, so the ingress can see them:</p>

<pre><code class="language-sh">kubectl expose deployment shiny1 --target-port=3838  --type=NodePort
kubectl expose deployment shiny2 --target-port=80  --type=NodePort
</code></pre>

<h4 id="create-ingress-with-ngninx">Create Ingress with ngninx</h4>

<p>This lets you be able to call the different services from one ip address.</p>

<p>Save this as <code>r-ingress-nginx.yaml</code></p>

<pre><code class="language-yaml">apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: r-ingress-nginx
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/rewrite-target: / 
    nginx.ingress.kubernetes.io/ssl-redirect: &quot;false&quot;
spec:
  rules:
  - http:
      paths:
      - path: /wordcloud/
      # app deployed to /wordcloud/
        backend:
          serviceName: shiny2
          servicePort: 80
      - path: /gar/
      # app deployed to /gar/shiny/
        backend:
          serviceName: shiny1
          servicePort: 3838

</code></pre>

<p>Deploy via</p>

<pre><code class="language-sh">kubectl apply -f r-ingress-nginx.yaml
</code></pre>

<p>Verify and keep refreshing until it has an ip address assigned in the <code>ADDRESS</code> field (5mins)</p>

<pre><code class="language-sh">kubectl get ingress r-ingress-nginx
</code></pre>

<h4 id="see-your-deployed-containers">See your deployed containers</h4>

<p>The Nginx ingress controller takes care of any URL path not covered in the <code>r-ingress-nginx</code> ingress.  By default this should give a <code>default backend - 404</code> message.</p>

<ul>
<li><code>/gar/shiny/</code> is served by the googleAuthR demo app.  <code>/gar/</code> covers the standard Shiny welcome screen, and <code>/shiny/</code> is the folder that is configured in the Dockerfile</li>
<li><code>/wordcloud/</code> holds the Wordcloud Shiny app. In this case, the Shiny app is configured to appear in the root directory of the <code>/wordcloud/</code> URL.</li>
</ul>

<p>Here are some screenshots:</p>

<p><img src="../images/gar_app.png" alt="googleAuthR app" /></p>

<p><img src="../images/wordcloud.png" alt="Wordcloud app" /></p>

<p><img src="../images/default404.png" alt="Default webpage if not defined in ingress" /></p>

<p>Note it matters where you put the app in your Dockerfile.  The <code>nginx.ingress.kubernetes.io/rewrite-target: /</code> line in the ingress lets you specify a URL that is relative to your specified URLs.</p>

<p>If you want to have your app served on the absolute URL specified in the Dockerfile, see below for a no-redirect version.</p>

<h4 id="no-redirects">No redirects</h4>

<p>Without redirects work too, but the Shiny app needs to have the correct URL path configured in its Docker that matches the URLs you are specifying in the Ingress e.g. for our examples as the googleAuthR demo is in path <code>/shiny/</code> and the Wordcloud demo in the root <code>/</code>, the Ingress rules need to match those. Beware clashes where two Shiny apps have configured to the same URL path, e.g. root <code>/</code></p>

<p>Save this as <code>r-ingress-nginx-noredirect.yaml</code></p>

<pre><code class="language-yaml">apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: r-ingress-nginx
  annotations:
    kubernetes.io/ingress.class: nginx
    #nginx.ingress.kubernetes.io/rewrite-target: / # not used in this example
    nginx.ingress.kubernetes.io/ssl-redirect: &quot;false&quot;
spec:
  rules:
  - http:
      paths:
      - path: /
        backend:
          serviceName: shiny2
          servicePort: 80
      - path: /shiny/
        backend:
          serviceName: shiny1
          servicePort: 3838
</code></pre>

<p>Deploy via</p>

<pre><code>kubectl apply -f r-ingress-nginx-noredirect.yaml
</code></pre>

<p>Again, the Nginx ingress controller takes care of any URL path not covered in the <code>r-ingress-nginx</code> ingress.</p>

<p>However now:</p>

<ul>
<li><code>/shiny/</code> is served by the googleAuthR demo app.<br /></li>
<li><code>/</code> holds the Wordcloud Shiny app.</li>
</ul>

<h3 id="b1-r-apis-plumber">B1: R APIs - plumber</h3>

<p><em>edit 8th Feb, 2019</em> - seems most people are using <a href="https://www.rplumber.io/">plumber</a> these days for R APIs, so I&rsquo;ve updated to include an example of that as well as OpenCPU</p>

<p>Kubernetes is well suited to serving R APIs as they can auto-scale to demand, covering peaks and troughs in demand.</p>

<p>Plumber has its own Docker container at <code>tresletech/plumber</code> so you can use that as a basis for your own deployments.</p>

<p>An example below deploys the demo from plumber&rsquo;s website.</p>

<p>Say you have an R script that uses plumber such as below:</p>

<pre><code>#* Echo back the input
#* @param msg The message to echo
#* @get /api/echo
function(msg=&quot;&quot;){
  list(msg = paste0(&quot;The message is: '&quot;, msg, &quot;'&quot;))
}

#* Plot a histogram
#* @png
#* @get /api/plot
function(){
  rand &lt;- rnorm(100)
  hist(rand)
}

#* Return the sum of two numbers
#* @param a The first number to add
#* @param b The second number to add
#* @post /api/sum
function(a, b){
  as.numeric(a) + as.numeric(b)
}
</code></pre>

<p>You could include your own libraries etc as well, but in that case make sure to install them in the Dockerfile as well so they are available in its environment.</p>

<p>A Dockerfile can be very simple - it only uses the premade plumber Docker image then copies in your script (and perhaps installs any dependencies you want).  The <code>CMD</code> line specifies which R script to use in plumber.</p>

<pre><code>FROM trestletech/plumber
WORKDIR /payload/
COPY [&quot;.&quot;,&quot;./&quot;]

CMD [&quot;api.R&quot;]
</code></pre>

<p>The folder structure is arranged so the Dockerfile will pick up and copy in your plumber script when building:</p>

<pre><code>|
|- Dockerfile
|- api.R
</code></pre>

<p>Deploy and build your Dockerfile so its available for Kubernetes.  I use GitHub and <a href="https://cloud.google.com/cloud-build/">Google Cloud Build</a> to have it in a private repo, so thats its available at <code>gcr.io/your-project/my-plumber</code>.  This means as I make changes to my plumber script and commit to GitHub, it will rebuild the image.</p>

<p>Now we want to deploy the image to Kubernetes:</p>

<pre><code class="language-sh">kubectl run my-plumber --image gcr.io/your-project/my-plumber --port 8000
</code></pre>

<p>Expose the port as before:</p>

<pre><code class="language-sh">kubectl expose deployment my-plumber --target-port=8000  --type=NodePort
</code></pre>

<p>And create the ingress so it can speak with the outside world:</p>

<pre><code class="language-yaml">apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: r-ingress-nginx
  annotations:
    kubernetes.io/ingress.class: nginx
    #nginx.ingress.kubernetes.io/rewrite-target: /
    nginx.ingress.kubernetes.io/ssl-redirect: &quot;false&quot;
spec:
  rules:
  - http:
      paths:
      - path: /api/
        backend:
          serviceName: my-plumber
          servicePort: 8000
</code></pre>

<blockquote>
<p>This assumes you have configured the ingress controller above</p>
</blockquote>

<p>You can then call your plumber API.  In the ingress above its configured to be within the Â´/api/` folder, so all the plumber functions are relative to that.  Assuming your public ip address is 1.2.3.4, this means you can use curl to test your API:</p>

<pre><code class="language-bash">curl http://1.2.3.4/api/echo?msg=&quot;its alive!&quot;
#&gt; &quot;The message is: its alive!&quot;
</code></pre>

<h3 id="b2-r-apis-opencpu">B2: R APIs - OpenCPU</h3>

<p>An alternative to plumber is using <a href="https://www.opencpu.org/">OpenCPU</a>, which uses a package structure to construct R APIs.</p>

<p>A demo API is shown below, using <a href="http://code.markedmondson.me/predictClickOpenCPU/"><code>openCPU</code> for predicting website clicks</a>, but the same principle applies if using <code>plumber</code> or another framework by swapping out the Dockerfile to serve the API on a port.</p>

<blockquote>
<p>This assumes you have configured the ingress controller above</p>
</blockquote>

<pre><code class="language-sh">kubectl run opencpu-demo --image gcr.io/gcer-public/opencpu-demo:latest --port 8004
</code></pre>

<p>Expose the port as before:</p>

<pre><code class="language-sh">kubectl expose deployment opencpu-demo --target-port=8004  --type=NodePort
</code></pre>

<p>Now we do another Ingress deployment for the R-API, in addition to the Shiny apps above.</p>

<p>Save the below as <code>r-ingress-opencpu.yaml</code></p>

<pre><code class="language-yaml">apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: r-ingress-nginx-ocpu
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/ssl-redirect: &quot;false&quot;
spec:
  rules:
  - http:
      paths:
      - path: /ocpu/
        backend:
          serviceName: opencpu-demo
          servicePort: 8004
</code></pre>

<p>&hellip;and deploy via:</p>

<pre><code class="language-sh">kubectl apply -f r-ingress-opencpu.yaml
</code></pre>

<p>Your ip address will be as shown as your <code>ADDRESS</code> when you issue:</p>

<pre><code class="language-sh">kubectl get ingress r-ingress-nginx-ocpu
#&gt; NAME                   HOSTS     ADDRESS         PORTS     AGE
#&gt; r-ingress-nginx-ocpu   *         35.205.249.34   80        10m
</code></pre>

<p>Note no rewriting this time as OpenCPU takes care of itself on <code>/ocpu/</code> folder.</p>

<h3 id="use-your-opencpu-installation">Use your OpenCPU installation</h3>

<p>Assuming your IP is <code>1.2.3.4</code>; we can see the OpenCPU is installed via <code>1.2.3.4/ocpu/info</code> and the test page at <code>1.2.3.4/ocpu/test/</code></p>

<p>For our example, the custom package uploaded is available at <code>1.2.3.4/ocpu/library/predictClickOpenCPU</code></p>

<p><img src="../images/open-cpu-running.png" alt="" /></p>

<p>We use the API for this package by creating a POST hit to API endpoint</p>

<p><code>1.2.3.4/ocpu/library/predictClickOpenCPU/R/predictMarkov/json</code></p>

<p>&hellip;with the parameter <code>pageview_names=[&quot;/example/96&quot;,&quot;/example/213&quot;,&quot;/example/107&quot;]</code></p>

<p>Constructing the above in the terminal with <code>curl</code>, we test the API is functioning:</p>

<pre><code class="language-sh">curl --data 'pageview_names=[&quot;/example/96&quot;,&quot;/example/213&quot;,&quot;/example/107&quot;]' http://35.233.42.6/ocpu/library/predictClickOpenCPU/R/predictMarkov/json
#&gt; {
#  &quot;page&quot;: [&quot;/example/251&quot;],
#  &quot;probability&quot;: [0.5657]
#&gt; }
</code></pre>

<p>Web API endpoints can also be used as webhooks, for instance to react and do something when something is pushed to GitHub for continuous integration purposes.</p>

<h3 id="c-scheduled-r-tasks-via-cronjobs">C: Scheduled R - Tasks via cronJobs</h3>

<p>Kuberenetes has a special option for deploying scheduled tasks, called cronJobs.</p>

<p>When configuring your Dockerfile, you can choose so it runs entirely self-contained, perhaps calling an API and writing the result to a database.  For each new job you can make a new Dockerfile and build them on something like build triggers.</p>

<p>In that case the Dockerfile should run with all configuration files included in the Docker build.  One advantage of running on GKE is that the job can be authenticated with the same project via <a href="http://code.markedmondson.me/googleAuthR/reference/gar_gce_auth.html"><code>googleAuthR::gar_gce_auth()</code></a> so will have access to Google Cloud Storage, BigQuery etc.</p>

<p>An alternative is to configure the Dockerfile to rely on a config file, and have that config file mounted as a volume in the pod - that isn&rsquo;t covered here yet.</p>

<h4 id="creating-an-executable-r-dockerfile">Creating an executable R Dockerfile</h4>

<p>This is an example Dockerfile that installs dependencies and R packages, loads a local configuration file then runs a custom function when it is called upon by the cronJob:</p>

<pre><code class="language-docker">FROM rocker/verse
MAINTAINER Mark Edmondson (r@sunholo.com)

# install R package dependencies
RUN apt-get update &amp;&amp; apt-get install -y \
    gcc gsl-bin libblas-dev \
    ## etc....
    ## clean up
    &amp;&amp; apt-get clean \ 
    &amp;&amp; rm -rf /var/lib/apt/lists/ \ 
    &amp;&amp; rm -rf /tmp/downloaded_packages/ /tmp/*.rds

# any necessary environment arguments
ENV SECRET_ARG hellomum

# Install packages from CRAN and GitHub
RUN install2.r --error \ 
    -r 'http://cran.rstudio.com' \
    googleAuthR googleAnalyticsR bigQueryR \
    &amp;&amp; Rscript -e &quot;devtools::install_github('MarkEdmondson1234/youtubeAnalyticsR')&quot; \
    &amp;&amp; Rscript -e &quot;devtools::install_github('yourprivate/customPackage')&quot; \
    ## clean up
    &amp;&amp; rm -rf /tmp/downloaded_packages/ /tmp/*.rds

# my_config.yaml is in same folder as Dockerfile
COPY my_config.yaml my_config.yaml

## this runs when this Docker container is called
CMD [&quot;Rscript&quot;, &quot;-e&quot;, &quot;customPackage::do_something('my_config.yaml')&quot;]
</code></pre>

<h4 id="running-cronjobs">Running cronJobs</h4>

<p>For <a href="https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/">cronJobs</a>, specify the <code>schedule</code> argument, and we change the restart policy to only do so on failure.</p>

<pre><code class="language-sh">kubectl run scheduled-r --schedule=&quot;23 4 * * *&quot; --restart=OnFailure --image=gcr.io/xxxxxx/private_docker_image:latest
</code></pre>

<p>That is getting a bit complicated for the terminal , so I prefer to deploy via the file method:</p>

<pre><code class="language-yaml">apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: scheduledr
spec:
  schedule: &quot;23 4 * * *&quot;
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: my_image
            image: gcr.io/xxxxxx/private_docker_image:latest
          restartPolicy: OnFailure
</code></pre>

<p>Save the file as say <code>cron-r.yaml</code> and deploy via:</p>

<pre><code class="language-sh">kubectl create -f ./cron-r.yaml
</code></pre>

<p>You should then see the job has been created via</p>

<pre><code>kubectl get cronjob scheduledr
</code></pre>

<p>And in the Web UI under <a href="https://console.cloud.google.com/kubernetes/workload?project=iih-tools-analytics&amp;authuser=0&amp;workload_list_tablesize=50">Workloads</a></p>

<p><img src="../images/cronJob.png" alt="" /></p>

<h2 id="part-4-going-further">Part 4 - Going further</h2>

<p>This article turned into a lot more words than I intended, so I&rsquo;ll stop now, but see below on some more things I could have written about:</p>

<h3 id="updating-your-cluster">Updating your cluster</h3>

<p>Its a bit of configuration to get there, but once deployed since the services are running off Docker, and those in turn are built using build triggers that are from GitHub pushes, it means that changes to scripts can all be controlled via GitHub pushes and branches, which you are probably using anyway for version control.</p>

<p>When you change a configuration file and want to deploy, use <code>kubectl apply</code> instead of <code>kubectl create</code> to change the settings.</p>

<p>Its best practice to specify a dev and production branch to your GitHub Docker images, so you can safely test containers before you break your production.</p>

<h3 id="secrets-and-https-ssl-configuration">Secrets and https / SSL configuration</h3>

<p>Kubernetes supports more robust methods to guard your secrets that including them in the Dockerfiles - see <a href="https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets-as-environment-variables">here</a> for proper treatment.</p>

<p>Related to that is serving over https.  In this case I found Bitnami the easiest method to follow, using Helm again to <a href="https://docs.bitnami.com/kubernetes/how-to/secure-kubernetes-services-with-ingress-tls-letsencrypt/">configure TLS with LetsEncrypt and Kube-lego</a>.</p>

<h3 id="auto-scaling">Auto scaling</h3>

<p>Launching the cluster with these flags enables auto-scaling</p>

<pre><code class="language-sh">gcloud container clusters create r-cluster --num-nodes=0 --enable-autoscaling --min-nodes=0 --max-nodes=3
</code></pre>

<p>On Google Kubernetes Engine this scales down to 0, which should be cheaper than running a few CPUs running <sup>24</sup>&frasl;<sub>7</sub>, and you can configure when new nodes are launched such as when it hits 80% CPU.</p>

<h3 id="parallel-tasks">Parallel tasks</h3>

<p>For big parallel processing tasks, Kubernetes is an option that can launch as many CPUs you need.</p>

<p>However, you will need to configure your workload so that each service works on a different part of the data, so some form of central ledger is needed that keeps track of which rows on the database or files have been treated, and to remove them from the input files once completed.</p>

<p>A strategy to handle this is to use message brokers that specify which work needs to be done. An example of using a <a href="https://kubernetes.io/docs/tasks/job/coarse-parallel-processing-work-queue/">message broker is here</a>.</p>

<h3 id="and-finally">And finally&hellip;</h3>

<p>After all that, do remember to tear down your cluster and/or load balancers when finished with, as you are charged by minute of uptime per node.  Most tutorials include this at the end - you can either delete in the web UI but to be complete here:</p>

<ol>
<li>Delete the Ingress: This deallocates the ephemeral external IP address and the load balancing resources associated to your application:</li>
</ol>

<pre><code class="language-sh">kubectl delete ingress your-ingress
</code></pre>

<ol>
<li>Delete the cluster: This deletes the compute nodes of your container cluster and other resources such as the Deployments in the cluster:</li>
</ol>

<pre><code class="language-sh">gcloud container clusters delete r-cluster
</code></pre>

<h2 id="summary">Summary</h2>

<p>When working with Kubernetes documentation you can tell that it is a fast changing developing product, which can be a bit frustrating when looking for solutions, but I anticipate the APIs to settle down in the future.</p>

<p>This should hopefully serve as a good jumping off point for you to develop your own Kubernetes R cluster.  Having got Kubernetes under my belt I now feel fully tooled up for deploying R (and other applications) at scale, and in an exciting and developing framework that should stand in good sted for a few years to come.</p>
        </div>
        <footer class="article-footer">
    <a data-url="https://code.markedmondson.me/r-on-kubernetes-serverless-shiny-r-apis-and-scheduled-scripts/" data-id="5d2f2e03a581e0a6f63af02413be27e2" class="article-share-link">
        <i class="fa fa-share"></i>
        Share
    </a>
    
    <a href="https://code.markedmondson.me/r-on-kubernetes-serverless-shiny-r-apis-and-scheduled-scripts/#disqus_thread" class="article-comment-link">
        Comments
    </a>
    

    <script>
    (function ($) {
        
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
    </script>
</footer>

    </div>

    
<nav id="article-nav">
    
    <a href="https://code.markedmondson.me/embedding-google-data-studio-into-rmarkdown/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">
          Older
      </strong>
      <div class="article-nav-title">Embedding Google Data Studio into RMarkdown</div>
    </a>
    

    
    <a href="https://code.markedmondson.me/talking-google-analytics-dashboards/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">
          Newer
      </strong>
      <div class="article-nav-title">Talking Google Analytics dashboards via R, Shiny and Text-to-Speech APIs</div>
    </a>
    
</nav>


</article>


<section id="comments">
    <div id="disqus_thread">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "markedmondson" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
</section>


    </section>

   	
    	<aside id="sidebar">
    
<div class="widget-wrap">
    <h3 class="widget-title">
        Recents
    </h3>
    <div class="widget">
        <ul id="recent-post">
            
            <li>
                <div class="item-thumbnail">
                    <a href="https://code.markedmondson.me/r-at-scale-on-google-cloud-platform/" class="thumbnail">
                    
                        <span style="background-image:url(https://code.markedmondson.me/banners/r-at-scale.png)" alt="R on Kubernetes - serverless Shiny, R APIs and scheduled scripts" class="thumbnail-image"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-title"><a href="https://code.markedmondson.me/r-at-scale-on-google-cloud-platform/" class="title">R at scale on the Google Cloud Platform</a></p>
                    <p class="item-date">
                        <time datetime="2019-02-23 00:00:00 &#43;0000 UTC" itemprop="datePublished">2019-02-23</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="https://code.markedmondson.me/automatic-google-analytics-data-imports-cloud-storage/" class="thumbnail">
                    
                        <span style="background-image:url(https://code.markedmondson.me/banners/data-imports.jpg)" alt="R on Kubernetes - serverless Shiny, R APIs and scheduled scripts" class="thumbnail-image"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-title"><a href="https://code.markedmondson.me/automatic-google-analytics-data-imports-cloud-storage/" class="title">Auto Google Analytics Data Imports from Cloud Storage</a></p>
                    <p class="item-date">
                        <time datetime="2018-11-29 00:00:00 &#43;0000 UTC" itemprop="datePublished">2018-11-29</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="https://code.markedmondson.me/bigquery-ga360-exports-cloud-functions/" class="thumbnail">
                    
                        <span style="background-image:url(https://code.markedmondson.me/banners/cloud-functions.png)" alt="R on Kubernetes - serverless Shiny, R APIs and scheduled scripts" class="thumbnail-image"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-title"><a href="https://code.markedmondson.me/bigquery-ga360-exports-cloud-functions/" class="title">Turning GA360 BigQuery exports into partitioned tables using Cloud Functions</a></p>
                    <p class="item-date">
                        <time datetime="2018-10-09 00:00:00 &#43;0000 UTC" itemprop="datePublished">2018-10-09</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="https://code.markedmondson.me/talking-google-analytics-dashboards/" class="thumbnail">
                    
                        <span style="background-image:url(https://code.markedmondson.me/banners/talking-gas.png)" alt="R on Kubernetes - serverless Shiny, R APIs and scheduled scripts" class="thumbnail-image"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    
                    
                    <p class="item-title"><a href="https://code.markedmondson.me/talking-google-analytics-dashboards/" class="title">Talking Google Analytics dashboards via R, Shiny and Text-to-Speech APIs</a></p>
                    <p class="item-date">
                        <time datetime="2018-08-15 00:00:00 &#43;0000 UTC" itemprop="datePublished">2018-08-15</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="https://code.markedmondson.me/r-on-kubernetes-serverless-shiny-r-apis-and-scheduled-scripts/" class="thumbnail">
                    
                        <span style="background-image:url(https://code.markedmondson.me/banners/r-kubernetes.png)" alt="R on Kubernetes - serverless Shiny, R APIs and scheduled scripts" class="thumbnail-image"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    
                    
                    <p class="item-title"><a href="https://code.markedmondson.me/r-on-kubernetes-serverless-shiny-r-apis-and-scheduled-scripts/" class="title">R on Kubernetes - serverless Shiny, R APIs and scheduled scripts</a></p>
                    <p class="item-date">
                        <time datetime="2018-05-02 00:00:00 &#43;0000 UTC" itemprop="datePublished">2018-05-02</time>
                    </p>
                </div>
            </li>
            
        </ul>
    </div>
</div>


    





    


<div class="widget-wrap">
    <h3 class="widget-title">
        Tags
    </h3>
    <div class="widget">
        <ul class="category-list">
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://code.markedmondson.me/tags/big-query">
                    big-query
                </a>
                <span class="category-list-count">5</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://code.markedmondson.me/tags/blogging">
                    blogging
                </a>
                <span class="category-list-count">2</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://code.markedmondson.me/tags/cloud-functions">
                    cloud-functions
                </a>
                <span class="category-list-count">2</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://code.markedmondson.me/tags/docker">
                    docker
                </a>
                <span class="category-list-count">6</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://code.markedmondson.me/tags/google-analytics">
                    google-analytics
                </a>
                <span class="category-list-count">8</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://code.markedmondson.me/tags/google-app-engine">
                    google-app-engine
                </a>
                <span class="category-list-count">4</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://code.markedmondson.me/tags/google-auth">
                    google-auth
                </a>
                <span class="category-list-count">3</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://code.markedmondson.me/tags/google-cloud-storage">
                    google-cloud-storage
                </a>
                <span class="category-list-count">4</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://code.markedmondson.me/tags/google-compute-engine">
                    google-compute-engine
                </a>
                <span class="category-list-count">7</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://code.markedmondson.me/tags/google-language">
                    google-language
                </a>
                <span class="category-list-count">2</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://code.markedmondson.me/tags/google-tag-manager">
                    google-tag-manager
                </a>
                <span class="category-list-count">3</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://code.markedmondson.me/tags/python">
                    python
                </a>
                <span class="category-list-count">4</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://code.markedmondson.me/tags/r">
                    r
                </a>
                <span class="category-list-count">17</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://code.markedmondson.me/tags/rstudio-server">
                    rstudio-server
                </a>
                <span class="category-list-count">4</span>
            </li>
            
            <li class="category-list-item">
                
                <a class="category-list-link" href="https://code.markedmondson.me/tags/search-console">
                    search-console
                </a>
                <span class="category-list-count">3</span>
            </li>
            
        </ul>
    </div>
</div>




    


    <div id="toTop" class="fa fa-angle-up"></div>
</aside>

    
	</div>
</div>

<footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019
      Powered by <a href="//gohugo.io">Hugo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>.
    </div>
  </div>
</footer>


<script src="https://code.markedmondson.me/fancybox/jquery.fancybox.pack.js"></script>
<script src="https://code.markedmondson.me/js/script.js"></script>
<script src="https://code.markedmondson.me/js/highlight.pack.js"></script>


<script>hljs.initHighlightingOnLoad();</script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>




</body>
</html>